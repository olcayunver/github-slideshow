#!/bin/sh

set -e

echo "ðŸ” Checking slideshow optimizations..."

cd "$(dirname "$0")/.."

# Check if optimization files exist
echo "==> Checking optimization files..."

if [ -f "sw.js" ]; then
  echo "âœ“ Service worker found"
else
  echo "âœ— Service worker missing"
fi

if grep -q "preload" _includes/head.html; then
  echo "âœ“ Resource preloading enabled"
else
  echo "âœ— Resource preloading not found"
fi

if grep -q "compress_html" _config.yml; then
  echo "âœ“ HTML compression configured"
else
  echo "âœ— HTML compression not configured"
fi

if grep -q "incremental: true" _config.yml; then
  echo "âœ“ Incremental builds enabled"
else
  echo "âœ— Incremental builds not enabled"
fi

# Check reveal.js configuration
echo ""
echo "==> Checking Reveal.js optimizations..."

if grep -q "condition:" _includes/script.html; then
  echo "âœ“ Conditional plugin loading enabled"
else
  echo "âœ— Conditional plugin loading not found"
fi

if grep -q "transitionSpeed.*fast" _config.yml; then
  echo "âœ“ Fast transitions configured"
else
  echo "âœ— Fast transitions not configured"
fi

# Check build scripts
echo ""
echo "==> Checking build scripts..."

if grep -q "JEKYLL_ENV=production" script/cibuild; then
  echo "âœ“ Production environment in CI build"
else
  echo "âœ— Production environment not set in CI build"
fi

if grep -q "livereload" script/server; then
  echo "âœ“ Live reload enabled for development"
else
  echo "âœ— Live reload not enabled for development"
fi

echo ""
echo "ðŸŽ¯ Optimization check complete!"
echo ""
echo "Performance tips:"
echo "  â€¢ Use 'bundle exec jekyll serve --profile' to analyze build performance"
echo "  â€¢ Check browser Network tab for resource loading efficiency"
echo "  â€¢ Test offline functionality with service worker"
echo "  â€¢ Monitor Core Web Vitals in production"